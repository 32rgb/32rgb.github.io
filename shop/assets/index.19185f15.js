import{M as a,O as e,a7 as t,X as l,U as n,r as s,o,a4 as i,a0 as u,_ as c,a2 as r,a8 as d,Y as p,$ as v,a6 as m,a9 as f,a5 as g,c as h,a1 as _,Z as y}from"./vendor.e5c0db2e.js";import{g as w,c as x,a as b}from"./order.32c4a20a.js";/* empty css              */import"./index.ff69f4d4.js";a("data-v-4726a950");const k={class:"container"},C={class:"info"},I=["textContent"],z=["textContent"],V={class:"detail"},U={key:0,class:"default"},j=["textContent"],R={class:"product-list"},$=["src"],D={class:"info"},F=["textContent"],P={class:"price"},S={class:"count"},q=_("去支付");e();const A={props:{cartId:{type:String,required:!0}},setup(a){const{cartId:e}=a,_=t(!1),A=()=>_.value=!0,E=t(""),G=a=>{_.value=!1,K.value=a},K=t({}),M=t([]),O=l((()=>0===M.value.length));(async()=>{const{data:a}=await w({limit:5,page:1});200===a.status&&(M.value=(a=>a.map((a=>{const e={id:a.id,name:a.real_name,tel:a.phone,address:a.province+a.city+a.district+a.detail,isDefault:a.is_default};return 1===a.is_default&&(E.value=a.id,K.value=e),e})))(a.data))})();const T=n(),X=()=>{T.push({name:"address",params:{cartId:e}})},Y=(a,e)=>y("编辑地址:"+e),Z=t({}),B=l((()=>{var a;return null==(a=Z.value)?void 0:a.cartInfo})),H=l((()=>{var a;return`共${(null==(a=B.value)?void 0:a.length)||0}件`})),J=l((()=>{var a,e;return 100*((null==(e=null==(a=Z.value)?void 0:a.priceGroup)?void 0:e.totalPrice)||0)}));(async()=>{const{data:a}=await x({cartId:e,new:0});200===a.status&&(Z.value=a.data)})();const L=t(!1),N=t("yue"),Q=l((()=>{var a;return(null==(a=Z.value)?void 0:a.userInfo.now_money)||0})),W=async()=>{const{data:a}=await b(Z.value.orderKey,{addressId:K.value.id,payType:N.value});200===a.status&&(y.success("支付成功，自动跳转登录页..."),T.push({name:"order"}))};return(a,e)=>{const t=s("van-nav-bar"),l=s("van-empty"),n=s("van-address-list"),y=s("van-popup"),w=s("van-cell"),x=s("van-cell-group"),b=s("van-submit-bar"),T=s("van-icon"),Z=s("van-radio"),aa=s("van-button"),ea=s("van-radio-group"),ta=s("van-action-sheet");return o(),i(m,null,[u(t,{title:"订单确认","left-text":"返回","left-arrow":""}),c("div",k,[c("div",{class:"address-card",onClick:A},[c("p",C,[c("span",{class:"username",textContent:r(K.value.name)},null,8,I),c("span",{textContent:r(K.value.tel)},null,8,z)]),c("p",V,[K.value.isDefault?(o(),i("span",U,"[默认]")):d("",!0),c("span",{textContent:r(K.value.address)},null,8,j)])]),u(y,{show:_.value,"onUpdate:show":e[1]||(e[1]=a=>_.value=a),position:"bottom"},{default:p((()=>[u(n,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=a=>E.value=a),list:M.value,"default-tag-text":"默认",onClickItem:G,onAdd:X,onEdit:Y},f({_:2},[v(O)?{name:"top",fn:p((()=>[u(l,{description:"还没有地址哦~"})]))}:void 0]),1032,["modelValue","list"])])),_:1},8,["show"]),c("div",R,[u(x,null,{default:p((()=>[u(w,{title:v(H)},null,8,["title"])])),_:1}),u(x,null,{default:p((()=>[(o(!0),i(m,null,g(v(B),(a=>(o(),h(w,{class:"product",key:a.id},{default:p((()=>[c("img",{src:a.productInfo.image,alt:""},null,8,$),c("div",D,[c("p",{class:"title",textContent:r(a.productInfo.store_name)},null,8,F),c("p",P,"￥"+r(a.truePrice),1)]),c("span",S,"x"+r(a.cart_num),1)])),_:2},1024)))),128))])),_:1})])]),u(b,{price:v(J),label:"订单总结：","button-text":"立即付款",onSubmit:e[2]||(e[2]=a=>L.value=!0)},null,8,["price"]),u(ta,{show:L.value,"onUpdate:show":e[7]||(e[7]=a=>L.value=a),title:"请选择支付方式","cancel-text":"取消","close-on-click-action":""},{default:p((()=>[u(ea,{modelValue:N.value,"onUpdate:modelValue":e[6]||(e[6]=a=>N.value=a)},{default:p((()=>[u(x,null,{default:p((()=>[u(w,{clickable:"",title:"微信支付",label:"微信快捷支付",onClick:e[3]||(e[3]=a=>N.value="wechat"),size:"large",center:""},{icon:p((()=>[u(T,{name:"http://www.lgstatic.com/lg-app-fed/pay/images/wechat_b787e2f4.png",size:"30",style:{marginRight:"12px"}})])),"right-icon":p((()=>[u(Z,{name:"wechat","checked-color":"#ee0a24"})])),_:1}),u(w,{clickable:"",title:"支付宝",label:"支付宝快捷支付",onClick:e[4]||(e[4]=a=>N.value="alipay"),size:"large",center:""},{icon:p((()=>[u(T,{name:"http://www.lgstatic.com/lg-app-fed/pay/images/ali_ed78fdae.png",size:"30",style:{marginRight:"12px"}})])),"right-icon":p((()=>[u(Z,{name:"alipay","checked-color":"#ee0a24"})])),_:1}),u(w,{clickable:"",title:"余额支付",label:`可用余额为：${v(Q)}元`,onClick:e[5]||(e[5]=a=>N.value="yue"),size:"large",center:""},{icon:p((()=>[u(T,{name:"gold-coin",color:"#FF9900",size:"30",style:{marginRight:"12px"}})])),"right-icon":p((()=>[u(Z,{name:"yue","checked-color":"#ee0a24"})])),_:1},8,["label"]),u(w,null,{default:p((()=>[u(aa,{round:"",type:"danger",block:"",onClick:W},{default:p((()=>[q])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["show"])],64)}},__scopeId:"data-v-4726a950"};export{A as default};
